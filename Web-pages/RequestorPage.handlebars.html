<!doctype html>
<html>


	<head>
		
		<!-- Latest compiled and minified CSS -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

		<!-- Optional theme -->
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

		<!-- Include Date Range Picker -->

		<link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/bootstrap.daterangepicker/2/daterangepicker.css" />


	</head>



	<body>
		
		<nav class="navbar navbar-default">
		  <div class="container-fluid">
		    <!-- Brand and toggle get grouped for better mobile display -->
		    <div class="navbar-header">
		      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
		        <span class="sr-only">Toggle navigation</span>
		        <span class="icon-bar"></span>
		        <span class="icon-bar"></span>
		        <span class="icon-bar"></span>
		      </button>
		      <a class="navbar-brand" href="#">Requestor Home Screen</a>
		    </div>

		    <!-- Collect the nav links, forms, and other content for toggling -->
		    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
		      <ul class="nav navbar-nav">
		   
		        <li class="dropdown">
		          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Menu <span class="caret"></span></a>
		          <ul class="dropdown-menu">
		            <li><a href="Login.html">Sign out</a></li>
		          </ul>
		        </li>
		      </ul>
		      
		      
		    </div><!-- /.navbar-collapse -->
		  </div><!-- /.container-fluid -->
		</nav>
		
		<form id ="createApp" data-id="{{appId}}">
		<hr>
		<h2>Costs</h2>
		<div class = "container">
			<div class="input-group">
			  <span class="input-group-addon" id="basic-addon1">Registration costs</span>
			  <input type="text" class="form-control" id = "regCost" aria-label="Amount (to the nearest dollar)">
			  <span class="input-group-addon">.00</span>
			</div>

			<div class="input-group">
			<span class="input-group-addon" id="basic-addon2">Transportation costs</span>
			  <input type="text" class="form-control" id = "transpCost" aria-label="Amount (to the nearest dollar)">
			  <span class="input-group-addon">.00</span>
			</div>

			<div class="input-group">
			  <span class="input-group-addon">Housing costs</span>
			  <input type="text" class="form-control" id="houseCost"  aria-label="Amount (to the nearest dollar)">
			  <span class="input-group-addon">.00</span>
			</div>

			<div class="input-group">
			  <span class="input-group-addon">Food costs</span>
			  <input type="text" class="form-control" id="foodCost" aria-label="Amount (to the nearest dollar)">
			  <span class="input-group-addon">.00</span>
			</div>
			
			<div class="input-group">
			  <span class="input-group-addon">Advance Funds Required</span>
			  <input type="checkbox" id="advFund" class="form-control">
			</div>
	</div>

		<hr>
		<h2>Application details</h2>
		<div class = container>
			<div class="input-group">
			  <span class="input-group-addon">Presentation Title</span>
			  <input type="text" id="presTitle" class="form-control">
			</div>


			<div class="input-group">
			  <span class="input-group-addon">Presentation Type</span>
			  <input type="text" id="presType" class="form-control">
			</div>

			<div class="input-group">
			  <span class="input-group-addon">Conference Start Date</span>
			  <input type="date" id="confStart" class="form-control">
			</div>

			<div class="input-group">
			  <span class="input-group-addon">Conference End Date</span>
			  <input type="date" id="confEnd" class="form-control">
			</div>

			<div class="input-group">
			  <span class="input-group-addon">Conference location</span>
			  <input type="text" id="confLoc" class="form-control">
			</div>

			<div class="input-group">
			  <span class="input-group-addon">Conference Website</span>
			  <input type="text" id="website" class="form-control">
			</div>


			<div class="input-group geozone">
			  <span class="input-group-addon">Geographic zone</span>
			  <input type="radio" name="geo"  class="form-control"> North America <br>
			  <input type="radio" name="geo"  class="form-control"> South America <br>
			  <input type="radio" name="geo" class="form-control"> Europe <br>
			  <input type="radio" name="geo"  class="form-control"> Asia <br>
			  <input type="radio" name="geo"  class="form-control"> Africa <br>
			  <input type="radio" name="geo"  class="form-control"> Oceania <br>
			</div>
		
		</div>
		</form>


		<br>
		<br>
		<div class="btn-group" role="group" aria-label="...">
		  <button type="button" class="btn btn-default" id="submit" >Submit Application</button>
		  <button type="button" class="btn btn-default" id="save">Save and exit</button>
		</div>

		




		<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
	    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js">
	    </script>
	    <!-- Include all compiled plugins (below), or include individual files as needed -->
	    <script src="js/bootstrap.min.js"></script>
			<!-- Latest compiled and minified JavaScript -->
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
		<script type="text/javascript" src="//cdn.jsdelivr.net/bootstrap.daterangepicker/2/daterangepicker.js"></script>
		<script type="text/javascript" src="//cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
		<script type="text/javascript" src="//cdn.jsdelivr.net/jquery/1/jquery.min.js"></script>
		<script type="text/javascript" src="//cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>



	</body>

<script>
  $(function() {
    $('#save').click(verify)

    function verify(e) {
      e.preventDefault()

      var data = {
        grantApplication: { 
        	presentationTitle: $('#presTitle').val(),
        	presentationTypeName: $('#presType').val(),
        	requestAdvanceFunds: $('#advFund').val()
        }, 
        expense:{

        inscription: $('#regCost').val(),
        transport: $('#transpCost').val(),
        logement: $('#houseCost').val(),
        repas: $('#foodCost').val()
    	
    	},

    	conference: {
        startDate :$('#confStart').val(),
        endDate: $('#confEnd').val(),
        location: $('#confLoc').val(),
        website: $('#website').val(),
        geoZoneName: $('#geozone[type=radio]:checked').val()
    	}	

      }
      var path = $('createApp').data("appId")
      $.ajax('/application/' + path, {
        method: "PUT",
        headers: {
            'Accept': 'application/json',
            'Content-Type': 'application/json'
        },
        data: JSON.stringify(data)
      })
      .done(function(response) {
        window.location = "/menu"
      })
      .fail(function(response) {
        alert(response.responseText)
      })
        
    }


    
    $('#submit').click(verifySubmit)

    function verifySubmit(e) {
      e.preventDefault()

       var data = {
        grantApplication: { 
        	presentationTitle: $('#presTitle').val(),
        	presentationTypeName: $('#presType').val(),
        	requestAdvanceFunds: $('#advFund').val()
        }, 
        expense:{

        inscription: $('#regCost').val(),
        transport: $('#transpCost').val(),
        logement: $('#houseCost').val(),
        repas: $('#foodCost').val()
    	
    	},

    	conference: {
        startDate :$('#confStart').val(),
        endDate: $('#confEnd').val(),
        location: $('#confLoc').val(),
        website: $('#website').val(),
        geoZoneName: $('#geozone[type=radio]:checked').val()
    	}	

      }

      var flag = true;
      Object.keys(data).forEach(function(outerKey) {
      	var innerObj = data[outerKey]

      	Object.keys(innerObj).forEach(function(innerKey) {
      		if (!innerObj[innerKey]) {
      			flag = false;
      		}
      	})
      })

      if (flag) { 
      		var path = $('createApp').data("appId")
		      $.ajax('/application/' += path, {
		        method: "PUT",
		        headers: {
		            'Accept': 'application/json',
		            'Content-Type': 'application/json'
		        },
		        data: JSON.stringify(data)
		      })
		      .done(function(response) {
		        $.ajax('/application/' + path + "/submit", {
		        method: "PUT",
		        headers: {
		            'Accept': 'application/json',
		            'Content-Type': 'application/json'
		        	}
		        
		      	})
		      	.done(function(response) {
		      		alert("Successful Sumission of application")
		      	})
		      	.fail(function(response) {
		      		alert(response.responseText)
		      	})
		      })
		      .fail(function(response) {
		        alert(response.responseText)
		      })

      	}
      
     } 
    
  })
</script>





</html>